

1)
SELECT w.FIRST_NAME,w.LAST_NAME,NULLIF(COUNT(s.SECTION_ID),0) AS COUNTED_SECTIONS
FROM INSTRUCTOR w LEFT OUTER JOIN SECTION s 
ON w.INSTRUCTOR_ID = s.INSTRUCTOR_ID
GROUP BY w.FIRST_NAME,w.LAST_NAME
ORDER BY w.LAST_NAME;


2)
select
  w.course_no
from
  course w,
  section z,
  grade s
where
  z.course_no = w.course_no and
  s.section_id = z.section_id
group by
  w.course_no 
having
  count(distinct s.grade_type_code) = 
  (select count(distinct grade_type_code) from grade)
order by w.course_no;

3) 
SELECT lt.ZIP, COUNT(STUDENTS) as STUDENTS
FROM ZIPCODE lt
LEFT OUTER JOIN
(SELECT z.ZIP,s.STUDENT_ID, e.ENROLL_DATE  AS STUDENTS
FROM STUDENT s
LEFT JOIN ZIPCODE z ON s.ZIP = z.ZIP
LEFT JOIN ENROLLMENT e ON s.STUDENT_ID = e.STUDENT_ID 
WHERE z.STATE = 'NY'
AND z.CITY = 'Flushing'
GROUP BY z.ZIP,s.STUDENT_ID,e.ENROLL_DATE) rt
ON lt.ZIP = rt.ZIP
WHERE lt.STATE = 'NY'
AND lt.CITY = 'Flushing'
GROUP BY lt.ZIP
ORDER BY lt.ZIP;
ORDER BY lt.ZIP;

4)
SELECT DISTINCT lt.COURSE_NO, lt.DESCRIPTION, NVL(SUM(ENROLLMENTS),0) AS ENROLLMENTS
FROM COURSE lt
LEFT OUTER JOIN
(SELECT DISTINCT c.COURSE_NO, c.DESCRIPTION, w.STUDENT_ID, NVL(COUNT(e.ENROLL_DATE),0) AS ENROLLMENTS
FROM COURSE c , SECTION s, ENROLLMENT e, STUDENT w
WHERE c.COURSE_NO = s.COURSE_NO
AND s.SECTION_ID = e.SECTION_ID
AND e.STUDENT_ID = w.STUDENT_ID
AND DESCRIPTION LIKE '%Java%'
GROUP BY c.COURSE_NO, c.DESCRIPTION,w.STUDENT_ID
ORDER BY c.COURSE_NO) rt
ON lt.COURSE_NO = rt.COURSE_NO
WHERE lt.DESCRIPTION LIKE '%Java%'
GROUP BY lt.COURSE_NO, lt.DESCRIPTION
ORDER BY lt.COURSE_NO;





5) 

SELECT lt.STUDENT_ID,lt.FIRST_NAME, lt.LAST_NAME,(CASE WHEN TO_CHAR(SUM(ENROLLMENTS))=0 THEN 'none' ELSE TO_CHAR(SUM(ENROLLMENTS)) END) ENROLLMENTS
FROM STUDENT lt
LEFT OUTER JOIN
(SELECT s.STUDENT_ID, z.COURSE_NO,COUNT(e.ENROLL_DATE) AS ENROLLMENTS
FROM   STUDENT s
LEFT   JOIN ENROLLMENT e ON s.STUDENT_ID = e.STUDENT_ID
LEFT   JOIN SECTION z ON e.SECTION_ID = z.SECTION_ID
WHERE  s.PHONE LIKE '617%'
GROUP  BY s.STUDENT_ID, z.COURSE_NO) rt
ON lt.STUDENT_ID = rt.STUDENT_ID
WHERE lt.PHONE LIKE '617%'
GROUP BY lt.STUDENT_ID,lt.FIRST_NAME, lt.LAST_NAME,ENROLLMENTS
ORDER BY lt.LAST_NAME,lt.FIRST_NAME;








